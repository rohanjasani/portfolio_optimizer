# Portfolio Optimization and Performance Analysis

## Description
This project provides a tool for portfolio optimization and performance analysis using historical stock data. The script retrieves stock price data, calculates Sharpe ratios, builds a custom portfolio, generates random portfolio weights, and visualizes the results using `plotly` with a 3D plot.

## Visualization Example
Here's an example of the 3D plot generated by this script:

![Portfolio Optimization 3D Plot](./assets/portfolio_optimization_3d_plot.gif)

This GIF demonstrates how different combinations of stock weights affect the portfolio's performance, as measured by the Sharpe ratio.

## Setup and Running the Script
1. Ensure you have R and RStudio installed on your system.
2. Clone this repository or download the R script.
3. Open RStudio and set your working directory to where the R script is located.
4. Run the script to:
   - Retrieve stock data
   - Calculate portfolio returns
   - Generate random portfolio weights
   - Visualize the optimal portfolio

**Note:** The script may take over 1 minute to run completely. This is because it needs to webscrape and process the stock data before creating the 3D visualization. Please be patient while it executes.

The script includes a package management section at the beginning:

```r
# List of required packages
required_packages <- c("tidyverse", "tidyquant", "furrr", "plotly")

# Install missing packages
for (lib in required_packages) {
    if (!require(lib, character.only = TRUE)) {
        install.packages(lib, dependencies = TRUE)
        library(lib, character.only = TRUE)
    }
}
```

This code will:
- Install any missing required packages.
- Automatically load all necessary libraries before running the analysis.

## Features
- Retrieves historical stock data for user-specified companies (default: AAPL, GOOG, NFLX).
- Calculates monthly returns and Sharpe ratios for selected stocks and a benchmark (default: XLK).
- Builds a custom portfolio with adjustable weights.
- Generates random portfolio weights and identifies the optimal portfolio based on Sharpe ratios.
- Visualizes portfolio performance using an interactive 3D plot.

## Usage
1. **Stock Selection:**
   - Replace default stock symbols (AAPL, GOOG, NFLX) with your own company's tickers in the code.
   - Update the section where stock components are retrieved:
   ```r
   returns_m_components_tbl <- c("AAPL", "GOOG", "NFLX") %>%
   ```
   
2. **Adjust Portfolio Weights:**
   - Modify the custom weights for the stocks:
   ```r
   wts_tbl <- returns_m_components_tbl %>%
       distinct(symbol) %>%
       mutate(weights = c(0.25, 0.25, 0.5))
   ```
   
3. **Random Portfolio Generation:**
   - The script generates 250 random portfolios by default. You can adjust the number of iterations as needed:
   ```r
   iter  <- 250
   ```

4. **Visualization:**
   - After running the script, an interactive 3D plot will visualize how stock weight combinations impact portfolio performance based on Sharpe ratios.
   - Remember that generating this visualization may take over a minute due to data processing and calculations.

## Data
This project uses historical stock data retrieved through the `tidyquant` package, which serves as a convenient wrapper for various financial data APIs. Here are some key points about the data:

- **Data Source**: The stock price data is primarily sourced from Yahoo Finance.
- **Time Frame**: By default, the script retrieves data from January 1, 2013, up to the current date. You can modify this range in the code if needed.
- **Stock Selection**: The script is set up to analyze AAPL (Apple), GOOG (Google), and NFLX (Netflix) by default, with XLK (Technology Select Sector SPDR Fund) as a benchmark. You can easily modify these to analyze different stocks.
- **Data Frequency**: The script uses monthly returns for its calculations. This is derived from daily closing prices.
- **Data Fields**: The retrieved data includes open, high, low, close, volume, and adjusted prices. For the analysis, we primarily use the adjusted closing prices.
- **Data Processing**: Raw price data is transformed into returns, which are then used to calculate various metrics like the Sharpe ratio.
- **Data Limitations**: Be aware that free data sources may have limitations in terms of data accuracy, timeliness, or completeness. For critical financial decisions, consider using professional-grade data sources.

Ensure your internet connection is active when running the script to fetch the data. The webscraping and data processing contribute significantly to the script's execution time.

## Performance Considerations
- The script's execution time (over 1 minute) is primarily due to:
  1. Webscraping stock data from online sources
  2. Processing and calculating returns and ratios
  3. Generating random portfolios
  4. Creating the 3D visualization
- Execution time may vary based on your internet connection speed and computer's processing power.
- For larger datasets or more iterations, expect longer processing times.

## Author

**Rohan Jasani**  
Email: jasani.rohan@gmail.com